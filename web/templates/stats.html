{% extends "base.html" %}

{% block title %}Stats - Running Log{% endblock %}

{% block content %}
<!-- Overall Progress -->
<div class="card">
    <div class="card-title">Progress to 50km Ultra</div>
    <div class="big-number">
        {{ stats.total_distance|round(1) }} <small>km</small>
    </div>
    <div class="progress-container" style="margin-top: 1rem;">
        <div class="progress-bar" style="width: {{ stats.ultra_progress }}%"></div>
    </div>
    <div class="progress-text">
        <span>{{ stats.ultra_progress|round(1) }}% complete</span>
        <span>{{ (stats.ultra_goal - stats.total_distance)|round(1) }} km to go</span>
    </div>
</div>

<!-- Training Stats -->
<div class="card">
    <div class="card-title">Training Statistics</div>
    <table class="stats-table">
        <tr>
            <span class="stats-label">Total Runs</span>
            <span class="stats-value">{{ stats.run_count }}</span>
        </tr>
        <tr>
            <span class="stats-label">Total Distance</span>
            <span class="stats-value">{{ stats.total_distance|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Average per Run</span>
            <span class="stats-value">{{ avg_distance|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Longest Run</span>
            <span class="stats-value">{{ max_distance|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Shortest Run</span>
            <span class="stats-value">{{ min_distance|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Current Streak</span>
            <span class="stats-value">{{ streak }} day{% if streak != 1 %}s{% endif %}</span>
        </tr>
    </table>
</div>

<!-- Plan Progress -->
<div class="card">
    <div class="card-title">Plan Progress</div>
    <table class="stats-table">
        <tr>
            <span class="stats-label">Plan Completion</span>
            <span class="stats-value">{{ stats.plan_progress|round(1) }}%</span>
        </tr>
        <tr>
            <span class="stats-label">Planned Total</span>
            <span class="stats-value">{{ stats.total_planned|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Planned Days</span>
            <span class="stats-value">{{ stats.planned_days }}</span>
        </tr>
        <tr>
            <span class="stats-label">Days Completed</span>
            <span class="stats-value">{{ stats.run_count }}</span>
        </tr>
    </table>
</div>

<!-- This Week -->
<div class="card">
    <div class="card-title">This Week</div>
    <table class="stats-table">
        <tr>
            <span class="stats-label">Distance Run</span>
            <span class="stats-value">{{ week_summary.total_run|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Target</span>
            <span class="stats-value">{{ week_summary.total_target|round(1) }} km</span>
        </tr>
        <tr>
            <span class="stats-label">Difference</span>
            <span class="stats-value {% if week_summary.total_run >= week_summary.total_target %}diff-positive{% else %}diff-negative{% endif %}">
                {% if week_summary.total_run >= week_summary.total_target %}+{% endif %}{{ (week_summary.total_run - week_summary.total_target)|round(1) }} km
            </span>
        </tr>
        <tr>
            <span class="stats-label">Days Logged</span>
            <span class="stats-value">{{ week_summary.days_logged }}</span>
        </tr>
    </table>
</div>

{% if best_week %}
<div class="card">
    <div class="card-title">Best Week</div>
    <div class="big-number">
        {{ best_week[1]|round(1) }} <small>km</small>
    </div>
    <p style="color: #666; margin-top: 0.5rem;">
        Week of {{ best_week[0].strftime('%b %d, %Y') }}
    </p>
</div>
{% endif %}
{% endblock %}
