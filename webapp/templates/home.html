{% extends "base.html" %}

{% block header_title %}Running Log{% endblock %}
{% block header_subtitle %}Track your weekly progress{% endblock %}

{% block content %}
<!-- This Week Card -->
<div class="bg-white rounded-2xl shadow-md p-5 mb-4">
    <h2 class="text-xs uppercase tracking-wide text-gray-500 font-medium mb-3">This Week</h2>

    <!-- Progress Bar -->
    <div class="bg-gray-200 rounded-full h-4 mb-2 overflow-hidden">
        <div class="bg-gradient-to-r from-emerald-500 to-emerald-400 h-full rounded-full transition-all duration-500"
             style="width: {{ [week_summary.progress_percent, 100]|min }}%"></div>
    </div>

    <!-- Progress Text -->
    <div class="flex justify-between text-sm text-gray-600 mb-4">
        <span class="font-semibold text-emerald-600">{{ week_summary.total_run|format_distance }} km</span>
        <span>of {{ week_summary.total_target|format_distance }} km target</span>
    </div>

    <!-- Stats Row -->
    <div class="flex justify-around text-center border-t pt-4">
        <div>
            <div class="text-2xl font-bold text-emerald-600">{{ week_summary.total_run|format_distance }}</div>
            <div class="text-xs uppercase tracking-wide text-gray-500">km Run</div>
        </div>
        <div class="border-l border-r px-6">
            <div class="text-2xl font-bold text-gray-700">{{ week_summary.total_target|format_distance }}</div>
            <div class="text-xs uppercase tracking-wide text-gray-500">km Target</div>
        </div>
        <div>
            <div class="text-2xl font-bold text-gray-700">{{ week_summary.days_logged }}</div>
            <div class="text-xs uppercase tracking-wide text-gray-500">Runs Logged</div>
        </div>
    </div>
</div>

<!-- Today's Target Card -->
{% if today_target %}
<div class="bg-gradient-to-r from-amber-50 to-yellow-50 border-2 border-amber-300 rounded-2xl p-5 mb-4">
    <h2 class="text-xs uppercase tracking-wide text-amber-700 font-medium mb-2">Today's Target</h2>
    <div class="flex items-center justify-between">
        <span class="text-3xl font-bold text-amber-600">{{ today_target|format_distance }} km</span>
        {% if today_distance %}
            <span class="bg-emerald-500 text-white px-3 py-1 rounded-full text-sm font-medium">
                Logged: {{ today_distance|format_distance }} km
            </span>
        {% else %}
            <a href="{{ url_for('runs.log') }}"
               class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-xl text-sm font-medium transition">
                Log Now
            </a>
        {% endif %}
    </div>
</div>
{% endif %}

<!-- Recent Runs Card -->
<div class="bg-white rounded-2xl shadow-md p-5">
    <h2 class="text-xs uppercase tracking-wide text-gray-500 font-medium mb-3">Recent Runs</h2>

    {% if recent_runs %}
    <ul class="divide-y divide-gray-100">
        {% for run in recent_runs %}
        <li class="py-3 flex justify-between items-center">
            <div>
                <div class="font-medium text-gray-900 flex items-center gap-2">
                    {{ run.date|format_date }}
                    {% if run.source == 'strava' %}
                    <svg class="w-4 h-4 text-[#FC4C02]" viewBox="0 0 24 24" fill="currentColor" title="From Strava">
                        <path d="M15.387 17.944l-2.089-4.116h-3.065L15.387 24l5.15-10.172h-3.066m-7.008-5.599l2.836 5.598h4.172L10.463 0l-7.008 13.828h4.172"/>
                    </svg>
                    {% endif %}
                </div>
                {% if run.target %}
                <div class="text-xs text-gray-500">Target: {{ run.target|format_distance }} km</div>
                {% endif %}
                {% if run.duration_formatted or run.pace_formatted %}
                <div class="text-xs text-gray-500">
                    {% if run.duration_formatted %}{{ run.duration_formatted }}{% endif %}
                    {% if run.duration_formatted and run.pace_formatted %} Â· {% endif %}
                    {% if run.pace_formatted %}{{ run.pace_formatted }}/km{% endif %}
                </div>
                {% endif %}
            </div>
            <div class="flex items-center gap-3">
                <span class="text-lg font-semibold text-emerald-600">{{ run.distance|format_distance }} km</span>
                <a href="{{ url_for('runs.edit_run', run_id=run.id) }}" class="text-gray-400 hover:text-emerald-600">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                </a>
            </div>
        </li>
        {% endfor %}
    </ul>

    <a href="{{ url_for('dashboard.dashboard') }}"
       class="block text-center text-emerald-600 hover:text-emerald-700 font-medium mt-4 text-sm">
        View All Runs &rarr;
    </a>
    {% else %}
    <div class="text-center py-8 text-gray-500">
        <p>No runs logged yet.</p>
        <a href="{{ url_for('runs.log') }}" class="text-emerald-600 hover:text-emerald-700 font-medium">Log your first run</a>
    </div>
    {% endif %}
</div>
{% endblock %}
